"use strict";var myMap,intervalId,soundLevel,burger=document.querySelector(".burger"),hideMenu=document.querySelector(".hide-menu"),hideMenuClose=document.querySelector(".hide-menu__close"),commentAvatars=(burger.addEventListener("click",function(e){e.preventDefault(),hideMenu.classList.add("hide-menu--active")}),hideMenuClose.addEventListener("click",function(e){e.preventDefault(),hideMenu.classList.remove("hide-menu--active")}),document.querySelector("#commentAvatars")),findReview=function(e){document.querySelector(".reviews__item.active").classList.remove("active"),document.querySelector('.reviews__item[data-linked-with="'.concat(e,'"]')).classList.add("active")},init=(commentAvatars.addEventListener("click",function(e){e.preventDefault();var t,e=e.target;e.classList.contains("interactive-avatar__img")&&((t=document.querySelector(".interactive-avatar--active"))&&t.classList.remove("interactive-avatar--active"),e=(t=e.parentElement).parentElement,t=t.getAttribute("data-open"),e.classList.add("interactive-avatar--active"),findReview(t))}),hideMenu.addEventListener("click",function(e){e.preventDefault(),e.target.classList.contains("hide-menu__link")&&hideMenu.classList.remove("hide-menu--active")}),function(){myMap=new ymaps.Map("map",{center:[59.938951,30.315635],zoom:11,controls:[]});for(var e=[[60.007082,30.259321],[59.888601,30.475086]],t=new ymaps.GeoObjectCollection({},{draggable:!1,iconLayout:"default#image",iconImageHref:"svg/marker.svg",iconImageSize:[58,73],iconImageOffset:[-35,-52]}),n=0;n<e.length;n++)t.add(new ymaps.Placemark(e[n]));myMap.geoObjects.add(t),myMap.behaviors.disable("scrollZoom")}),validateFields=(ymaps.ready(init),!function(){function o(e){var t=e.find(".menu-acco__item"),e=e.find(".menu-acco__content");t.removeClass("active"),e.width(0)}function i(e){var t,n,o=e.find(".menu-acco__content"),i=(r=e,t=0,a=$(window).width(),i=r.closest(".menu-acco__list").find(".menu-acco__button"),c=i.width()*i.length,r.find(".menu-acco__content"),r=window.matchMedia("(max-width: 768px)").matches,(n=window.matchMedia("(max-width: 480px)").matches)&&(t=a-i.width()),r&&(t=a-c),{container:t=r||n?t:500}),a=e.find(".menu-acco__desc"),c=e.find(".menu-acco__content"),r=window.matchMedia("(max-width: 480px)").matches;e.addClass("active"),o.width(i.container),a.width(i.textContainer),r&&c.width("100%")}$(".menu-acco__button").on("click",function(e){e.preventDefault();var e=$(e.currentTarget),t=e.closest(".menu-acco__item"),n=t.hasClass("active"),e=e.closest(".menu-acco__list");window.matchMedia("(max-width: 480px)").matches;n?o(e):(o(e),i(t))})}(),function(e,t){return t.forEach(function(e){e.removeClass("input-error"),""===e.val().trim()&&e.addClass("input-error")}),0===e.find(".input-error").length}),sections=($(".form").submit(function(e){e.preventDefault();var e=$(e.currentTarget),t=e.find("[name='name']"),n=e.find("[name='phone']"),o=e.find("[name='comment']"),i=e.find("[name='to']"),a=$("#modal"),c=a.find(".modal__content");a.removeClass("error-modal"),validateFields(e,[t,n,o,i])&&((e=$.ajax({url:"https://webdev-api.loftschool.com/sendmail",method:"post",data:{name:t.val(),phone:n.val(),comment:o.val(),to:i.val()},error:function(e){}})).done(function(e){c.text(e.message)}),e.fail(function(e){e=e.responseJSON.message;c.text(e),a.addClass("error-modal")}),e.always(function(){$.fancybox.open({src:"#modal",type:"inline"})}))}),$(".app-submit-btn").click(function(e){e.preventDefault(),$.fancybox.close()}),$("section")),display=$(".main-content"),sideMenu=$(".fixed-menu"),menuItems=sideMenu.find(".fixed-menu__item"),mobileDetect=new MobileDetect(window.navigator.userAgent),isMobile=mobileDetect.mobile(),inScroll=!1,countSectionPosition=(sections.first().addClass("active"),function(e){e*=-100;return isNaN(e)?(console.error("передано неверное значение в countSectionPosition"),0):e}),changeMenuThemeForSection=function(e){var e=sections.eq(e).attr("data-sidemenu-theme"),t=$(".fixed-menu__link");"white"===e?(sideMenu.addClass("fixed-menu--light"),t.addClass("fixed-menu__link--light")):(sideMenu.removeClass("fixed-menu--shadowed"),t.removeClass("fixed-menu__link--light"))},resetActiveClassForItem=function(e,t,n){e.eq(t).addClass(n).siblings().removeClass(n)},performTransition=function(e){var t;inScroll||(inScroll=!0,t=countSectionPosition(e),changeMenuThemeForSection(e),display.css({transform:"translateY(".concat(t,"%)")}),resetActiveClassForItem(sections,e,"active"),setTimeout(function(){inScroll=!1,resetActiveClassForItem(menuItems,e,"fixed-menu__item--active")},1e3))},viewportScroller=function(){var e=sections.filter(".active"),t=e.next(),n=e.prev();return{next:function(){t.length&&performTransition(t.index())},prev:function(){n.length&&performTransition(n.index())}}},pageScroll=($(window).on("wheel",function(e){var e=e.originalEvent.deltaY,t=viewportScroller();0<e&&t.next(),e<0&&t.prev()}),$(window).on("keydown",function(e){var t=e.target.tagName.toLowerCase(),t="input"===t||"textarea"===t,n=viewportScroller();if(!t)switch(e.keyCode){case 38:n.prev();break;case 40:n.next()}}),$(".wrapper").on("touchmove",function(e){return e.preventDefault()}),$("[data-scroll-to]").click(function(e){e.preventDefault();e=$(e.currentTarget).attr("data-scroll-to"),e=$("[data-section-id=".concat(e,"]"));performTransition(e.index())}),isMobile&&$("body").swipe({swipe:function(e,t){var n=viewportScroller(),t="down"===t?"prev":"up"===t?"next":"";t&&n[t]()}}),{block:function(){console.log("block!"),localStorage.setItem("isScrollLocked",!0)},unblock:function(){console.log("unblock!"),localStorage.setItem("isScrollLocked",!1)},toggleBlock:function(){this.isBlocked()?this.unblock():this.block()},isBlocked:function(){return console.log("blocked?",localStorage.getItem("isScrollLocked")),JSON.parse(localStorage.getItem("isScrollLocked"))}}),slider=(pageScroll.unblock(),$(".shop__list").bxSlider({pager:!1,controls:!1})),openItem=($(".shop__btn_left").click(function(e){e.preventDefault(),slider.goToPrevSlide()}),$(".shop__btn_right").click(function(e){e.preventDefault(),slider.goToNextSlide()}),function(e){var e=e.closest(".team__item"),t=e.find(".team__content"),n=t.find(".team__content-block").height(),o=e.find(".team__icon-img");e.addClass("active"),o.addClass("team__icon-img--active"),t.height(n)}),closeEveryItem=function(e){var t=e.find(".team__content"),n=e.find(".team__item"),e=e.find(".team__icon-img");n.removeClass("active"),e.removeClass("team__icon-img--active"),t.height(0)},playBtn=($(".team__button").click(function(e){var e=$(e.currentTarget),t=e.closest(".team__list");e.closest(".team__item").hasClass("active")?closeEveryItem(t):(closeEveryItem(t),openItem(e))}),document.querySelector(".video__player-img")),video=document.getElementById("player"),playerPlayBrn=document.querySelector(".duration__img"),durationControl=document.getElementById("durationLevel"),soundControl=document.getElementById("micLevel"),soundBtn=document.getElementById("soundBtn"),dynamicBtn=document.getElementById("dynamic");function playStop(){playBtn.classList.toggle("video__player-img--active"),playerPlayBrn.classList.toggle("duration__img-pause"),video.paused?(video.play(),intervalId=setInterval(updateDuration,1e3/60)):(clearInterval(intervalId),video.pause())}function setVideoDuration(){video.currentTime=durationControl.value,updateDuration()}function updateDuration(){durationControl.value=video.currentTime;var e=video.duration/100,e=video.currentTime/e;durationControl.style.background="linear-gradient(90deg, #E01F3D 0%, #E01F3D ".concat(e,"%, #626262 ").concat(e,"%)")}function changeSoundVolume(){video.volume=soundControl.value/10,0===video.volume?soundBtn.classList.add("active"):soundBtn.classList.remove("active")}function soundOf(){0===video.volume?(video.volume=soundLevel,soundControl.value=10*soundLevel,soundBtn.classList.remove("active")):(soundLevel=video.volume,video.volume=0,soundControl.value=0,soundBtn.classList.add("active"))}window.addEventListener("load",function(){video.addEventListener("click",playStop);for(var e=document.querySelectorAll(".play"),t=0;t<e.length;t++)e[t].addEventListener("click",playStop);durationControl.min=0,durationControl.value=0,durationControl.max=video.duration,durationControl.addEventListener("input",setVideoDuration),soundControl.min=0,soundControl.max=10,soundControl.value=soundControl.max,soundControl.addEventListener("input",changeSoundVolume),dynamicBtn.addEventListener("click",soundOf)}),video.addEventListener("ended",function(){playBtn.classList.toggle("video__player-img--active"),playerPlayBrn.classList.remove("duration__img-pause"),video.currentTime=0});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImJ1cmdlci5qcyIsIm1hcC5qcyIsInZpZGVvLmpzIiwibW9kYWwuanMiLCJtZW51LWFjY28uanMiLCJvcHMuanMiLCJzY3JvbGwuanMiLCJzbGlkZXIuanMiLCJ0ZWFtLmpzIl0sIm5hbWVzIjpbIm15TWFwIiwiaW50ZXJ2YWxJZCIsInNvdW5kTGV2ZWwiLCJidXJnZXIiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJoaWRlTWVudSIsImhpZGVNZW51Q2xvc2UiLCJjb21tZW50QXZhdGFycyIsImFkZEV2ZW50TGlzdGVuZXIiLCJldmVudCIsInByZXZlbnREZWZhdWx0IiwiY2xhc3NMaXN0IiwiYWRkIiwicmVtb3ZlIiwiZmluZFJldmlldyIsInJldmlld05hbWUiLCJjb25jYXQiLCJpbml0IiwiZSIsImlkIiwidGFyZ2V0IiwiY29udGFpbnMiLCJhY3RpdmVMaXN0SXRlbSIsImxpc3RFbGVtZW50IiwiYnV0dG9uIiwicGFyZW50RWxlbWVudCIsImdldEF0dHJpYnV0ZSIsInltYXBzIiwiTWFwIiwiY2VudGVyIiwiem9vbSIsImNvbnRyb2xzIiwiY29vcmRzIiwibXlDb2xsZWN0aW9uIiwiR2VvT2JqZWN0Q29sbGVjdGlvbiIsImRyYWdnYWJsZSIsImljb25MYXlvdXQiLCJpY29uSW1hZ2VIcmVmIiwiaWNvbkltYWdlU2l6ZSIsImljb25JbWFnZU9mZnNldCIsImkiLCJsZW5ndGgiLCJQbGFjZW1hcmsiLCJnZW9PYmplY3RzIiwiYmVoYXZpb3JzIiwiZGlzYWJsZSIsInZhbGlkYXRlRmllbGRzIiwicmVhZHkiLCJjbG9zZUV2ZXJ5SXRlbUluQ29udGFpbmVyIiwiY29udGFpbmVyIiwiaXRlbXMiLCJmaW5kIiwiY29udGVudCIsInJlbW92ZUNsYXNzIiwid2lkdGgiLCJvcGVuSXRlbSIsIml0ZW0iLCJyZXFJdGVtV2lkdGgiLCJpc01vYmlsZSIsImhpZGRlbkNvbnRlbnQiLCJyZXFXaWR0aCIsInNjcmVlbldpZHRoIiwiJCIsIndpbmRvdyIsInRpdGxlc0Jsb2NrcyIsImNsb3Nlc3QiLCJ0aXRsZXNXaWR0aCIsImlzVGFibGV0IiwibWF0Y2hNZWRpYSIsIm1hdGNoZXMiLCJ0ZXh0QmxvY2siLCJ0ZXh0Q29udGFpbmVyIiwiYWRkQ2xhc3MiLCJvbiIsIiR0aGlzIiwiY3VycmVudFRhcmdldCIsIml0ZW1PcGVuZWQiLCJoYXNDbGFzcyIsImZvcm0iLCJmaWVsZHNBcnJheSIsImZvckVhY2giLCJmaWVsZCIsInZhbCIsInRyaW0iLCJzZWN0aW9ucyIsInN1Ym1pdCIsIm5hbWUiLCJwaG9uZSIsImNvbW1lbnQiLCJ0byIsIm1vZGFsIiwicmVxdWVzdCIsImFqYXgiLCJ1cmwiLCJtZXRob2QiLCJkYXRhIiwiZXJyb3IiLCJkb25lIiwidGV4dCIsIm1lc3NhZ2UiLCJmYWlsIiwicmVzcG9uc2VKU09OIiwiYWx3YXlzIiwiZmFuY3lib3giLCJvcGVuIiwic3JjIiwidHlwZSIsImNsaWNrIiwiY2xvc2UiLCJkaXNwbGF5Iiwic2lkZU1lbnUiLCJtZW51SXRlbXMiLCJtb2JpbGVEZXRlY3QiLCJNb2JpbGVEZXRlY3QiLCJuYXZpZ2F0b3IiLCJ1c2VyQWdlbnQiLCJtb2JpbGUiLCJpblNjcm9sbCIsImNvdW50U2VjdGlvblBvc2l0aW9uIiwiZmlyc3QiLCJzZWN0aW9uRXEiLCJwb3NpdGlvbiIsImlzTmFOIiwiY29uc29sZSIsImNoYW5nZU1lbnVUaGVtZUZvclNlY3Rpb24iLCJtZW51VGhlbWUiLCJlcSIsImF0dHIiLCJzaWRlTWVudUxpbmsiLCJyZXNldEFjdGl2ZUNsYXNzRm9ySXRlbSIsIml0ZW1FcSIsImFjdGl2ZUNsYXNzIiwic2libGluZ3MiLCJwZXJmb3JtVHJhbnNpdGlvbiIsImNzcyIsInRyYW5zZm9ybSIsInNldFRpbWVvdXQiLCJ0cmFuc2l0aW9uT3ZlciIsInZpZXdwb3J0U2Nyb2xsZXIiLCJhY3RpdmVTZWN0aW9uIiwiZmlsdGVyIiwibmV4dFNlY3Rpb24iLCJuZXh0IiwicHJldlNlY3Rpb24iLCJwcmV2IiwiaW5kZXgiLCJwYWdlU2Nyb2xsIiwiZGVsdGFZIiwib3JpZ2luYWxFdmVudCIsInNjcm9sbGVyIiwidGFnTmFtZSIsInRvTG93ZXJDYXNlIiwidXNlclR5cGluZ0luSW5wdXRzIiwia2V5Q29kZSIsInJlcVNlY3Rpb24iLCJzd2lwZSIsImRpcmVjdGlvbiIsInNjcm9sbERpcmVjdGlvbiIsImJsb2NrIiwibG9nIiwibG9jYWxTdG9yYWdlIiwic2V0SXRlbSIsInVuYmxvY2siLCJ0b2dnbGVCbG9jayIsInRoaXMiLCJpc0Jsb2NrZWQiLCJnZXRJdGVtIiwiSlNPTiIsInBhcnNlIiwic2xpZGVyIiwiYnhTbGlkZXIiLCJwYWdlciIsImdvVG9QcmV2U2xpZGUiLCJnb1RvTmV4dFNsaWRlIiwiY29udGVudEJsb2NrIiwicmVxSGVpZ2h0IiwiaGVpZ2h0Iiwic3ZnSWNvbiIsImNsb3NlRXZlcnlJdGVtIiwiaXRlbUNvbnRhaW5lciIsIml0ZW1TdmdJY29uIiwicGxheUJ0biIsInZpZGVvIiwiZ2V0RWxlbWVudEJ5SWQiLCJwbGF5ZXJQbGF5QnJuIiwiZHVyYXRpb25Db250cm9sIiwic291bmRDb250cm9sIiwic291bmRCdG4iLCJkeW5hbWljQnRuIiwicGxheVN0b3AiLCJ0b2dnbGUiLCJwYXVzZWQiLCJwbGF5Iiwic2V0SW50ZXJ2YWwiLCJ1cGRhdGVEdXJhdGlvbiIsImNsZWFySW50ZXJ2YWwiLCJwYXVzZSIsInNldFZpZGVvRHVyYXRpb24iLCJjdXJyZW50VGltZSIsInZhbHVlIiwic3RlcCIsImR1cmF0aW9uIiwicGVyY2VudCIsInN0eWxlIiwiYmFja2dyb3VuZCIsImNoYW5nZVNvdW5kVm9sdW1lIiwidm9sdW1lIiwic291bmRPZiIsInBsYXlCdXR0b25zIiwicXVlcnlTZWxlY3RvckFsbCIsIm1pbiIsIm1heCJdLCJtYXBwaW5ncyI6ImFBQUEsSUNBQUEsTUNRQUMsV0FDQUMsV0ZUQUMsT0FBQUMsU0FBQUMsY0FBQSxXQUNBQyxTQUFBRixTQUFBQyxjQUFBLGNBQ0FFLGNBQUFILFNBQUFDLGNBQUEscUJBbUNBRyxnQkFqQ0FMLE9BQUFN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R0FDQXpCLGFBQUFhLE1BQUFiLGFBQUF5QixJQUNBekIsYUFBQWxMLGlCQUFBLFFBQUFxTSxtQkFFQWpCLFdBQUFwTCxpQkFBQSxRQUFBdU0sV0FHQXpCLE1BQUE5SyxpQkFBQSxRQUFBLFdBQ0E2SyxRQUFBMUssVUFBQW1MLE9BQUEsNkJBQ0FOLGNBQUE3SyxVQUFBRSxPQUFBLHVCQUNBeUssTUFBQWdCLFlBQUEiLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImxldCBidXJnZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmJ1cmdlclwiKTtcclxubGV0IGhpZGVNZW51ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5oaWRlLW1lbnVcIik7XHJcbmxldCBoaWRlTWVudUNsb3NlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5oaWRlLW1lbnVfX2Nsb3NlXCIpO1xyXG5cclxuYnVyZ2VyLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbihldmVudCl7XHJcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgaGlkZU1lbnUuY2xhc3NMaXN0LmFkZCgnaGlkZS1tZW51LS1hY3RpdmUnKTtcclxufSlcclxuXHJcbmhpZGVNZW51Q2xvc2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uKGV2ZW50KXtcclxuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICBoaWRlTWVudS5jbGFzc0xpc3QucmVtb3ZlKCdoaWRlLW1lbnUtLWFjdGl2ZScpO1xyXG59KVxyXG5cclxuLy8g0YHQtdC60YbQuNGPINC+0YLQt9GL0LLRi1xyXG4vLyBjb25zdCBmaW5kQmxvY2tCeUFsaWFzID0gYWxpYXMgPT4ge1xyXG4vLyAgICAgcmV0dXJuICQoXCIucmV2aWV3c19faXRlbVwiKS5maWx0ZXIoKG5keCwgaXRlbSkgPT4ge1xyXG4vLyAgICAgICAgIHJldHVybiAkKGl0ZW0pLmF0dHIoXCJkYXRhLWxpbmtlZC13aXRoXCIpID09PSBhbGlhcztcclxuLy8gICAgIH0pXHJcbi8vIH1cclxuLy8gJChcIi5pbnRlcmFjdGl2ZS1hdmF0YXJfX2xpbmtcIikuY2xpY2soZSA9PiB7XHJcbi8vICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4vLyAgICAgY29uc3QgJHRoaXMgPSAkKGUuY3VycmVudFRhcmdldCk7XHJcbi8vICAgICBjb25zdCB0YXJnZXQgPSAkdGhpcy5hdHRyKFwiZGF0YS1vcGVuXCIpO1xyXG4vLyAgICAgY29uc3QgaXRlbVRvU2hvdyA9IGZpbmRCbG9ja0J5QWxpYXModGFyZ2V0KTtcclxuLy8gICAgIGNvbnN0IGN1ckl0ZW0gPSAkdGhpcy5jbG9zZXN0KFwiLnJldmlld3NfX3N3aXRjaGVyLWl0ZW1cIik7XHJcblxyXG5cclxuLy8gICAgIGl0ZW1Ub1Nob3cuYWRkQ2xhc3MoXCJhY3RpdmVcIikuc2libGluZ3MoKS5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKTtcclxuLy8gICAgIGN1ckl0ZW0uYWRkQ2xhc3MoXCJpbnRlcmFjdGl2ZS1hdmF0YXItLWFjdGl2ZVwiKS5zaWJsaW5ncygpLnJlbW92ZUNsYXNzKFwiaW50ZXJhY3RpdmUtYXZhdGFyLS1hY3RpdmVcIik7XHJcbi8vIH0pXHJcblxyXG5cclxuXHJcbi8vINGB0LXQutGG0LjRjyDQvtGC0LfRi9Cy0YtcclxuXHJcbmNvbnN0IGNvbW1lbnRBdmF0YXJzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjb21tZW50QXZhdGFyc1wiKTtcclxuXHJcbi8vINGE0YPQvdC60YbQuNGPINC/0L7QutCw0LfQsCDQvdGD0LbQvdC+0LPQviDQvtGC0LfRi9Cy0LAg0L/QviDQuNC80LXQvdC4XHJcbmNvbnN0IGZpbmRSZXZpZXcgPSAocmV2aWV3TmFtZSkgPT4ge1xyXG4gIC8vINC90LDRhdC+0LTQuNC8INGC0LXQutGD0YnQuNC5INC+0YLQvtCx0YDQsNC20LDQtdC80YvQuSDQvtGC0LfRi9CyICjRgyDQvdC10LPQviDQtNC+0LvQttC10L0g0LHRi9GC0Ywg0LDQutGC0LjQstC90YvQuSDQutC70LDRgdGBKVxyXG4gIGNvbnN0IGFjdGl2ZVJldmlldyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucmV2aWV3c19faXRlbS5hY3RpdmVcIik7XHJcbiAgLy8g0YHQvdC40LzQsNC10Lwg0YEg0YLQtdC60YPRidC10LPQviDQvtGC0L7QsdGA0LDQttCw0LXQvNC+0LPQviDQvtGC0LfRi9Cy0LAg0LDQutGC0LjQstC90YvQuSDQutC70LDRgdGBXHJcbiAgYWN0aXZlUmV2aWV3LmNsYXNzTGlzdC5yZW1vdmUoXCJhY3RpdmVcIik7XHJcbiAgLy8g0L3QsNGF0L7QtNC40Lwg0L3Rg9C20L3Ri9C5INC+0YLQt9GL0LIg0L/QviDQuNC80LXQvdC4ICjQv9C+INGB0LXQu9C10LrRgtC+0YDRgyDQtNCw0YLQsCDQsNGC0YDQuNCx0YPRgtCwKVxyXG4gIGxldCBjdXJyZW50SXRlbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYC5yZXZpZXdzX19pdGVtW2RhdGEtbGlua2VkLXdpdGg9XCIke3Jldmlld05hbWV9XCJdYCk7XHJcbiAgLy8g0Lgg0YHRgtCw0LLQuNC8INC90LAg0L3QtdCz0L4g0LDQutGC0LjQstC90YvQuSDQutC70LDRgdGBICjRhNCw0LrRgtC40YfQtdGB0LrQuCDQv9C+0LrQsNC30YvQstCw0LXQvCDQvdGD0LbQvdGL0Lkg0L7RgtC30YvQsilcclxuICBjdXJyZW50SXRlbS5jbGFzc0xpc3QuYWRkKFwiYWN0aXZlXCIpO1xyXG59O1xyXG4vLyDQv9GA0Lgg0LrQu9C40LrQsNGFINC90LAg0YHQv9C40YHQvtC6INCw0LLQsNGC0LDRgNC+0LpcclxuY29tbWVudEF2YXRhcnMuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XHJcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gIC8vINC90LDRhdC+0LTQuNC8INC/0L4g0LrQsNC60L7QvNGDINC40LzQtdC90L3QviDRjdC70LXQvNC10L3RgtGDINC60LvQuNC60L3Rg9C70LhcclxuICBjb25zdCB0YXJnZXQgPSBlLnRhcmdldDtcclxuICAvLyDQtdGB0LvQuCDQutC70LjQutC90YPQu9C4INC90LAg0LrQsNGA0YLQuNC90LrRg1xyXG4gIGlmICh0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwiaW50ZXJhY3RpdmUtYXZhdGFyX19pbWdcIikpIHtcclxuICAgIC8vINC40YnQtdC8INGC0LXQutGD0YnRg9GOINCw0LrRgtC40LLQvdGD0Y4g0LDQstCw0YLQsNGA0LrRg1xyXG4gICAgY29uc3QgYWN0aXZlTGlzdEl0ZW0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmludGVyYWN0aXZlLWF2YXRhci0tYWN0aXZlXCIpO1xyXG4gICAgLy8g0LXRgdC70Lgg0L3QsNGI0LvQuFxyXG4gICAgaWYgKGFjdGl2ZUxpc3RJdGVtKSB7XHJcbiAgICAgIC8vINGD0LHQuNGA0LDQtdC8INGBINC90LXRkSDQsNC60YLQuNCy0L3Ri9C5INC60LvQsNGB0YEgKNC30LXQu9C10L3Rg9GOINGA0LDQvNC60YMpXHJcbiAgICBhY3RpdmVMaXN0SXRlbS5jbGFzc0xpc3QucmVtb3ZlKFwiaW50ZXJhY3RpdmUtYXZhdGFyLS1hY3RpdmVcIik7XHJcbiAgICB9XHJcbiAgICAvLyDRgyDQutCw0YDRgtC40L3QutC4INC10YHRgtGMINGA0L7QtNC40YLQtdC70YwgLSDQutC90L7Qv9C60LBcclxuICAgIGNvbnN0IGJ1dHRvbiA9IHRhcmdldC5wYXJlbnRFbGVtZW50O1xyXG4gICAgLy8g0LAg0YMg0LrQvdC+0L/QutC4INC10YHRgtGMINGA0L7QtNC40YLQtdC70YwgPGxpPlxyXG4gICAgY29uc3QgbGlzdEVsZW1lbnQgPSBidXR0b24ucGFyZW50RWxlbWVudDtcclxuICAgIC8vINCx0LXRgNC10Lwg0YMg0LrQvdC+0L/QutC4INC40LzRjyDQvdGD0LbQvdC+0LPQviDQtNC70Y8g0L/QvtC60LDQt9CwINC+0YLQt9GL0LLQsFxyXG4gICAgY29uc3QgaWQgPSBidXR0b24uZ2V0QXR0cmlidXRlKFwiZGF0YS1vcGVuXCIpO1xyXG4gICAgLy8g0YEgPGxpPiDRgdC90LjQvNCw0LXQvCDQsNC60YLQuNCy0L3Ri9C5INC60LvQsNGB0YEgXHJcbiAgICBsaXN0RWxlbWVudC5jbGFzc0xpc3QuYWRkKFwiaW50ZXJhY3RpdmUtYXZhdGFyLS1hY3RpdmVcIik7XHJcbiAgICAvLyDQt9Cw0L/Rg9GB0LrQsNC10Lwg0YTRg9C90LrRhtC40Y4g0L/QvtC60LDQt9CwINC+0YLQt9GL0LLQsCDQuCDQv9C10YDQtdC00LDQtdC8INC/0L7Qu9GD0YfQtdC90L3QvtC1INGBINC60L3QvtC/0LrQuCDQuNC80Y8g0L7RgtC30YvQstCwIFxyXG4gICAgZmluZFJldmlldyhpZCk7XHJcbiAgfVxyXG59KTtcclxuXHJcbmhpZGVNZW51LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICBpZiAoZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnaGlkZS1tZW51X19saW5rJykpIHtcclxuICAgIGhpZGVNZW51LmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGUtbWVudS0tYWN0aXZlJyk7XHJcbiAgfVxyXG59KTtcclxuIiwibGV0IG15TWFwO1xyXG5jb25zdCBpbml0ID0gKCkgPT4ge1xyXG4gbXlNYXAgPSBuZXcgeW1hcHMuTWFwKFwibWFwXCIsIHtcclxuICBjZW50ZXI6IFs1OS45Mzg5NTEsIDMwLjMxNTYzNV0sXHJcbiAgIHpvb206IDExLFxyXG4gICBjb250cm9sczogW10sXHJcbiB9KTtcclxuIFxyXG4gbGV0IGNvb3JkcyA9IFtcclxuICAgICBcclxuICAgICBbNjAuMDA3MDgyLDMwLjI1OTMyMV0sXHJcbiAgICAgWzU5Ljg4ODYwMSwzMC40NzUwODZdXHJcbiAgIF0sXHJcbiAgIG15Q29sbGVjdGlvbiA9IG5ldyB5bWFwcy5HZW9PYmplY3RDb2xsZWN0aW9uKHt9LCB7XHJcbiAgICAgZHJhZ2dhYmxlOiBmYWxzZSxcclxuICAgICBpY29uTGF5b3V0OiAnZGVmYXVsdCNpbWFnZScsXHJcbiAgICAgaWNvbkltYWdlSHJlZjogJ3N2Zy9tYXJrZXIuc3ZnJyxcclxuICAgICBpY29uSW1hZ2VTaXplOiBbNTgsIDczXSxcclxuICAgICBpY29uSW1hZ2VPZmZzZXQ6IFstMzUsIC01Ml1cclxuICAgfSk7XHJcbiBcclxuIGZvciAobGV0IGkgPSAwOyBpIDwgY29vcmRzLmxlbmd0aDsgaSsrKSB7XHJcbiAgIG15Q29sbGVjdGlvbi5hZGQobmV3IHltYXBzLlBsYWNlbWFyayhjb29yZHNbaV0pKTtcclxuIH1cclxuIFxyXG4gbXlNYXAuZ2VvT2JqZWN0cy5hZGQobXlDb2xsZWN0aW9uKTtcclxuIFxyXG4gbXlNYXAuYmVoYXZpb3JzLmRpc2FibGUoJ3Njcm9sbFpvb20nKTtcclxufTtcclxuIFxyXG55bWFwcy5yZWFkeShpbml0KTsiLCJjb25zdCBwbGF5QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnZpZGVvX19wbGF5ZXItaW1nJyk7XHJcbmNvbnN0IHZpZGVvID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BsYXllcicpO1xyXG5jb25zdCBwbGF5ZXJQbGF5QnJuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmR1cmF0aW9uX19pbWcnKTtcclxuY29uc3QgZHVyYXRpb25Db250cm9sID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2R1cmF0aW9uTGV2ZWwnKTtcclxuY29uc3Qgc291bmRDb250cm9sID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21pY0xldmVsJyk7XHJcbmNvbnN0IHNvdW5kQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NvdW5kQnRuJyk7XHJcbmNvbnN0IGR5bmFtaWNCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZHluYW1pYycpO1xyXG5cclxubGV0IGludGVydmFsSWQ7IFxyXG5sZXQgc291bmRMZXZlbDtcclxuXHJcbi8vIHZpZGVvLmFkZEV2ZW50TGlzdGVuZXIoXCJsb2FkZWRkYXRhXCIsIGZ1bmN0aW9uICgpIHtcclxuICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsIGZ1bmN0aW9uKCkge1xyXG5cclxudmlkZW8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBwbGF5U3RvcCk7IFxyXG5sZXQgcGxheUJ1dHRvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucGxheScpO1xyXG5cclxuZm9yIChsZXQgaSA9IDA7IGkgPCBwbGF5QnV0dG9ucy5sZW5ndGg7IGkrKykge1xyXG4gIHBsYXlCdXR0b25zW2ldLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgcGxheVN0b3ApO1xyXG59XHJcblxyXG5kdXJhdGlvbkNvbnRyb2wubWluID0gMDtcclxuZHVyYXRpb25Db250cm9sLnZhbHVlID0gMDtcclxuZHVyYXRpb25Db250cm9sLm1heCA9IHZpZGVvLmR1cmF0aW9uO1xyXG5kdXJhdGlvbkNvbnRyb2wuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBzZXRWaWRlb0R1cmF0aW9uKTtcclxuXHJcbnNvdW5kQ29udHJvbC5taW4gPSAwO1xyXG5zb3VuZENvbnRyb2wubWF4ID0gMTA7XHJcbnNvdW5kQ29udHJvbC52YWx1ZSA9IHNvdW5kQ29udHJvbC5tYXg7XHJcbnNvdW5kQ29udHJvbC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIGNoYW5nZVNvdW5kVm9sdW1lKTtcclxuXHJcbmR5bmFtaWNCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBzb3VuZE9mKTtcclxufSk7XHJcblxyXG52aWRlby5hZGRFdmVudExpc3RlbmVyKCdlbmRlZCcsICgpID0+IHtcclxuICBwbGF5QnRuLmNsYXNzTGlzdC50b2dnbGUoJ3ZpZGVvX19wbGF5ZXItaW1nLS1hY3RpdmUnKTtcclxuICBwbGF5ZXJQbGF5QnJuLmNsYXNzTGlzdC5yZW1vdmUoJ2R1cmF0aW9uX19pbWctcGF1c2UnKTtcclxuICB2aWRlby5jdXJyZW50VGltZSA9IDA7XHJcbn0pXHJcblxyXG5mdW5jdGlvbiBwbGF5U3RvcCgpIHtcclxuICBwbGF5QnRuLmNsYXNzTGlzdC50b2dnbGUoJ3ZpZGVvX19wbGF5ZXItaW1nLS1hY3RpdmUnKTtcclxuICBwbGF5ZXJQbGF5QnJuLmNsYXNzTGlzdC50b2dnbGUoJ2R1cmF0aW9uX19pbWctcGF1c2UnKTtcclxuICBpZiAodmlkZW8ucGF1c2VkKSB7XHJcbiAgICB2aWRlby5wbGF5KCk7XHJcbiAgICBpbnRlcnZhbElkID0gc2V0SW50ZXJ2YWwodXBkYXRlRHVyYXRpb24sIDEwMDAgLyA2MCk7XHJcbiAgfSBlbHNlIHtcclxuICAgIGNsZWFySW50ZXJ2YWwoaW50ZXJ2YWxJZCk7XHJcbiAgICB2aWRlby5wYXVzZSgpO1xyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gc2V0VmlkZW9EdXJhdGlvbigpIHtcclxuICB2aWRlby5jdXJyZW50VGltZSA9IGR1cmF0aW9uQ29udHJvbC52YWx1ZTtcclxuICB1cGRhdGVEdXJhdGlvbigpO1xyXG59XHJcblxyXG5mdW5jdGlvbiB1cGRhdGVEdXJhdGlvbigpIHtcclxuICBkdXJhdGlvbkNvbnRyb2wudmFsdWUgPSB2aWRlby5jdXJyZW50VGltZTtcclxuICBsZXQgc3RlcCA9IHZpZGVvLmR1cmF0aW9uIC8gMTAwO1xyXG4gIGxldCBwZXJjZW50ID0gdmlkZW8uY3VycmVudFRpbWUgLyBzdGVwO1xyXG4gIGR1cmF0aW9uQ29udHJvbC5zdHlsZS5iYWNrZ3JvdW5kID0gYGxpbmVhci1ncmFkaWVudCg5MGRlZywgI0UwMUYzRCAwJSwgI0UwMUYzRCAke3BlcmNlbnR9JSwgIzYyNjI2MiAke3BlcmNlbnR9JSlgO1xyXG59XHJcblxyXG5mdW5jdGlvbiBjaGFuZ2VTb3VuZFZvbHVtZSgpIHtcclxuICB2aWRlby52b2x1bWUgPSBzb3VuZENvbnRyb2wudmFsdWUgLyAxMDtcclxuICBpZiAodmlkZW8udm9sdW1lID09PSAwKSB7XHJcbiAgICBzb3VuZEJ0bi5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTtcclxuICB9IGVsc2Uge1xyXG4gICAgc291bmRCdG4uY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7XHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBzb3VuZE9mKCkge1xyXG4gIGlmICh2aWRlby52b2x1bWUgPT09IDApIHtcclxuICAgIHZpZGVvLnZvbHVtZSA9IHNvdW5kTGV2ZWw7XHJcbiAgICBzb3VuZENvbnRyb2wudmFsdWUgPSBzb3VuZExldmVsICogMTA7XHJcbiAgICBzb3VuZEJ0bi5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcclxuICB9IGVsc2Uge1xyXG4gICAgc291bmRMZXZlbCA9IHZpZGVvLnZvbHVtZTtcclxuICAgIHZpZGVvLnZvbHVtZSA9IDA7XHJcbiAgICBzb3VuZENvbnRyb2wudmFsdWUgPSAwO1xyXG4gICAgc291bmRCdG4uY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7XHJcbiAgfVxyXG59IiwiY29uc3QgdmFsaWRhdGVGaWVsZHMgPSAoZm9ybSwgZmllbGRzQXJyYXkpID0+IHtcclxuXHJcbiAgICBmaWVsZHNBcnJheS5mb3JFYWNoKChmaWVsZCkgPT4ge1xyXG4gICAgICAgIGZpZWxkLnJlbW92ZUNsYXNzKFwiaW5wdXQtZXJyb3JcIik7XHJcbiAgICAgICAgaWYgKGZpZWxkLnZhbCgpLnRyaW0oKSA9PT0gXCJcIikge1xyXG4gICAgICAgICAgICBmaWVsZC5hZGRDbGFzcyhcImlucHV0LWVycm9yXCIpO1xyXG4gICAgICAgIH0gICAgICAgXHJcbiAgICB9KTtcclxuXHJcbiAgICBjb25zdCBlcnJvckZpZWxkcyA9IGZvcm0uZmluZChcIi5pbnB1dC1lcnJvclwiKTtcclxuICAgIHJldHVybiBlcnJvckZpZWxkcy5sZW5ndGggPT09IDA7XHJcbn1cclxuXHJcblxyXG4kKFwiLmZvcm1cIikuc3VibWl0KGV2ZW50ID0+IHtcclxuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gICAgY29uc3QgZm9ybSA9ICQoZXZlbnQuY3VycmVudFRhcmdldCk7XHJcbiAgICBjb25zdCBuYW1lID0gZm9ybS5maW5kKFwiW25hbWU9J25hbWUnXVwiKTtcclxuICAgIGNvbnN0IHBob25lID0gZm9ybS5maW5kKFwiW25hbWU9J3Bob25lJ11cIik7XHJcbiAgICBjb25zdCBjb21tZW50ID0gZm9ybS5maW5kKFwiW25hbWU9J2NvbW1lbnQnXVwiKTtcclxuICAgIGNvbnN0IHRvID0gZm9ybS5maW5kKFwiW25hbWU9J3RvJ11cIik7XHJcblxyXG4gICAgY29uc3QgbW9kYWwgPSAkKFwiI21vZGFsXCIpO1xyXG4gICAgY29uc3QgY29udGVudCA9IG1vZGFsLmZpbmQoXCIubW9kYWxfX2NvbnRlbnRcIik7IFxyXG5cclxuICAgIG1vZGFsLnJlbW92ZUNsYXNzKFwiZXJyb3ItbW9kYWxcIik7XHJcblxyXG4gICAgY29uc3QgaXNWYWxpZCA9IHZhbGlkYXRlRmllbGRzKGZvcm0sIFtuYW1lLCBwaG9uZSwgY29tbWVudCwgdG9dKTtcclxuXHJcbiAgICBpZiAoaXNWYWxpZCkge1xyXG4gICAgICAgIGNvbnN0IHJlcXVlc3QgPSAkLmFqYXgoe1xyXG4gICAgICAgICAgICB1cmw6IFwiaHR0cHM6Ly93ZWJkZXYtYXBpLmxvZnRzY2hvb2wuY29tL3NlbmRtYWlsXCIsXHJcbiAgICAgICAgICAgIG1ldGhvZDogXCJwb3N0XCIsXHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIG5hbWU6IG5hbWUudmFsKCksXHJcbiAgICAgICAgICAgICAgICBwaG9uZTogcGhvbmUudmFsKCksXHJcbiAgICAgICAgICAgICAgICBjb21tZW50OiBjb21tZW50LnZhbCgpLFxyXG4gICAgICAgICAgICAgICAgdG86IHRvLnZhbCgpLFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXJyb3I6IGRhdGEgPT4geyAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXF1ZXN0LmRvbmUoKGRhdGEpID0+IHtcclxuICAgICAgICAgICAgY29udGVudC50ZXh0KGRhdGEubWVzc2FnZSk7XHJcbiAgICAgICAgIFxyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIHJlcXVlc3QuZmFpbChkYXRhID0+IHtcclxuICAgICAgICAgICAgY29uc3QgbWVzc2FnZSA9IGRhdGEucmVzcG9uc2VKU09OLm1lc3NhZ2U7XHJcbiAgICAgICAgICAgIGNvbnRlbnQudGV4dChtZXNzYWdlKTtcclxuICAgICAgICAgICAgbW9kYWwuYWRkQ2xhc3MoXCJlcnJvci1tb2RhbFwiKTtcclxuXHJcbiAgICAgICAgICAgICBcclxuICAgICAgICB9KVxyXG5cclxuICAgICAgICByZXF1ZXN0LmFsd2F5cygoKSA9PiB7XHJcbiAgICAgICAgICAgICQuZmFuY3lib3gub3Blbih7XHJcbiAgICAgICAgICAgICAgICBzcmM6IFwiI21vZGFsXCIsXHJcbiAgICAgICAgICAgICAgICB0eXBlOiBcImlubGluZVwiXHJcbiAgICAgICAgICAgIH0pOyAgXHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuXHJcbn0pO1xyXG5cclxuJChcIi5hcHAtc3VibWl0LWJ0blwiKS5jbGljayhldmVudCA9PiB7XHJcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgICQuZmFuY3lib3guY2xvc2UoKTtcclxufSkiLCIoKCkgPT4ge1xyXG4gIFxyXG4vL2pxdWVyeVxyXG5cclxuY29uc3QgbWVzdXJlV2lkdGggPSBpdGVtID0+IHtcclxuICBsZXQgcmVxSXRlbVdpZHRoID0gMDtcclxuXHJcbiAgY29uc3Qgc2NyZWVuV2lkdGggPSAkKHdpbmRvdykud2lkdGgoKTtcclxuICBjb25zdCBjb250YWluZXIgPSBpdGVtLmNsb3Nlc3QoXCIubWVudS1hY2NvX19saXN0XCIpO1xyXG4gIGNvbnN0IHRpdGxlc0Jsb2NrcyA9IGNvbnRhaW5lci5maW5kKFwiLm1lbnUtYWNjb19fYnV0dG9uXCIpO1xyXG4gIGNvbnN0IHRpdGxlc1dpZHRoID0gdGl0bGVzQmxvY2tzLndpZHRoKCkgKiB0aXRsZXNCbG9ja3MubGVuZ3RoO1xyXG5cclxuICBjb25zdCB0ZXh0Q29udGFpbmVyID0gaXRlbS5maW5kKFwiLm1lbnUtYWNjb19fY29udGVudFwiKTtcclxuXHJcbiAgXHJcbiAgY29uc3QgaXNUYWJsZXQgPSB3aW5kb3cubWF0Y2hNZWRpYShcIihtYXgtd2lkdGg6IDc2OHB4KVwiKS5tYXRjaGVzO1xyXG4gIGNvbnN0IGlzTW9iaWxlID0gd2luZG93Lm1hdGNoTWVkaWEoXCIobWF4LXdpZHRoOiA0ODBweClcIikubWF0Y2hlcztcclxuXHJcbiAgaWYgKGlzTW9iaWxlKSB7XHJcbiAgICByZXFJdGVtV2lkdGggPSBzY3JlZW5XaWR0aCAtIHRpdGxlc0Jsb2Nrcy53aWR0aCgpO1xyXG4gICBcclxuICB9IFxyXG4gIGlmIChpc1RhYmxldCkge1xyXG4gICAgcmVxSXRlbVdpZHRoID0gc2NyZWVuV2lkdGggLSB0aXRsZXNXaWR0aDtcclxuICB9XHJcbiAgaWYgKCFpc1RhYmxldCAmJiAhaXNNb2JpbGUpIHtcclxuICAgIHJlcUl0ZW1XaWR0aCA9IDUwMDtcclxuICB9XHJcblxyXG4gXHJcbiAgXHJcbiAgcmV0dXJuIHtcclxuICAgIGNvbnRhaW5lcjogcmVxSXRlbVdpZHRoLFxyXG4gIH1cclxuXHJcbiB9O1xyXG5cclxuXHJcblxyXG5jb25zdCBjbG9zZUV2ZXJ5SXRlbUluQ29udGFpbmVyID0gY29udGFpbmVyID0+IHtcclxuICBjb25zdCBpdGVtcyA9IGNvbnRhaW5lci5maW5kKFwiLm1lbnUtYWNjb19faXRlbVwiKTtcclxuICBjb25zdCBjb250ZW50ID0gY29udGFpbmVyLmZpbmQoXCIubWVudS1hY2NvX19jb250ZW50XCIpO1xyXG5cclxuICBpdGVtcy5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKTtcclxuICBjb250ZW50LndpZHRoKDApO1xyXG59XHJcblxyXG5jb25zdCBvcGVuSXRlbSA9IChpdGVtKSA9PiB7XHJcbiAgY29uc3QgaGlkZGVuQ29udGVudCA9IGl0ZW0uZmluZChcIi5tZW51LWFjY29fX2NvbnRlbnRcIik7XHJcbiAgY29uc3QgcmVxV2lkdGggPSBtZXN1cmVXaWR0aChpdGVtKTtcclxuICBjb25zdCB0ZXh0QmxvY2sgPSBpdGVtLmZpbmQoXCIubWVudS1hY2NvX19kZXNjXCIpO1xyXG4gIGNvbnN0IHRleHRDb250YWluZXIgPSBpdGVtLmZpbmQoXCIubWVudS1hY2NvX19jb250ZW50XCIpO1xyXG4gIGNvbnN0IGlzTW9iaWxlID0gd2luZG93Lm1hdGNoTWVkaWEoXCIobWF4LXdpZHRoOiA0ODBweClcIikubWF0Y2hlcztcclxuXHJcblxyXG5cclxuICBpdGVtLmFkZENsYXNzKFwiYWN0aXZlXCIpO1xyXG4gIGhpZGRlbkNvbnRlbnQud2lkdGgocmVxV2lkdGguY29udGFpbmVyKTtcclxuICB0ZXh0QmxvY2sud2lkdGgocmVxV2lkdGgudGV4dENvbnRhaW5lcik7XHJcbiAgaWYgKGlzTW9iaWxlKSB7XHJcbiAgICB0ZXh0Q29udGFpbmVyLndpZHRoKCcxMDAlJylcclxuICB9XHJcbn1cclxuXHJcbiQoXCIubWVudS1hY2NvX19idXR0b25cIikub24oXCJjbGlja1wiLCBlID0+IHtcclxuICBlLnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gIGNvbnN0ICR0aGlzID0gJChlLmN1cnJlbnRUYXJnZXQpO1xyXG4gIGNvbnN0IGl0ZW0gPSAkdGhpcy5jbG9zZXN0KFwiLm1lbnUtYWNjb19faXRlbVwiKTtcclxuICBjb25zdCBpdGVtT3BlbmVkID0gaXRlbS5oYXNDbGFzcyhcImFjdGl2ZVwiKTtcclxuICBjb25zdCBjb250YWluZXIgPSAkdGhpcy5jbG9zZXN0KFwiLm1lbnUtYWNjb19fbGlzdFwiKTtcclxuICBjb25zdCBpc01vYmlsZSA9IHdpbmRvdy5tYXRjaE1lZGlhKFwiKG1heC13aWR0aDogNDgwcHgpXCIpLm1hdGNoZXM7XHJcblxyXG5cclxuICBpZiAoaXRlbU9wZW5lZCkge1xyXG4gICAgY2xvc2VFdmVyeUl0ZW1JbkNvbnRhaW5lcihjb250YWluZXIpXHJcblxyXG5cclxuICB9IGVsc2Uge1xyXG4gICAgY2xvc2VFdmVyeUl0ZW1JbkNvbnRhaW5lcihjb250YWluZXIpXHJcbiAgICBvcGVuSXRlbShpdGVtKTtcclxuICB9XHJcbiB9KTtcclxuXHJcblxyXG4vLyBjb25zdCBpc1RhYmxldCA9IHdpbmRvdy5tYXRjaE1lZGlhKFwiKG1heC13aWR0aDogNzY4cHgpXCIpLm1hdGNoZXM7XHJcbi8vIGNvbnN0IGlzTW9iaWxlID0gd2luZG93Lm1hdGNoTWVkaWEoXCIobWF4LXdpZHRoOiA0ODBweClcIikubWF0Y2hlcztcclxuXHJcbi8vIGlmIChpc1RhYmxldCkge1xyXG4vLyAgIHJlcUl0ZW1XaWR0aCA9IHNjcmVlbldpZHRoIC0gdGl0bGVzV2lkdGg7XHJcbi8vIH1cclxuLy8gaWYgKGlzTW9iaWxlKSB7XHJcbi8vICAgcmVxSXRlbVdpZHRoID0gc2NyZWVuV2lkdGggLSB0aXRsZXNCbG9ja3Mud2lkdGgoKTtcclxuLy8gfSBcclxuLy8gaWYgKCFpc1RhYmxldCAmJiAhaXNNb2JpbGUpIHtcclxuLy8gICByZXFJdGVtV2lkdGggPSA1MDA7XHJcbi8vIH1cclxuXHJcbi8vanMgXHJcbi8vIGNvbnN0IG1lbnUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2hvcml6b250YWxNZW51XCIpO1xyXG4vLyBjb25zdCBpdGVtcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubWVudS1hY2NvX19pdGVtXCIpO1xyXG5cclxuLy8gY29uc3QgZ2V0SXRlbVdpZHRoID0gKGl0ZW0pID0+IHtcclxuLy8gICBsZXQgcmVzdWx0V2lkdGggPSA1MjQ7XHJcbi8vICAgY29uc3Qgd2luZG93V2lkdGggPSB3aW5kb3cuaW5uZXJXaWR0aDtcclxuLy8gICBjb25zdCBpdGVtV2lkdGggPSBpdGVtLm9mZnNldFdpZHRoO1xyXG5cclxuLy8gICBjb25zdCBpc1RhYmxldCA9IHdpbmRvdy5tYXRjaE1lZGlhKFwiKG1heC13aWR0aDogNzY4cHgpXCIpLm1hdGNoZXM7XHJcbi8vICAgY29uc3QgaXNNb2JpbGUgPSB3aW5kb3cubWF0Y2hNZWRpYShcIihtYXgtd2lkdGg6IDQ4MHB4KVwiKS5tYXRjaGVzO1xyXG5cclxuLy8gICBpZiAoaXNUYWJsZXQpIHtcclxuLy8gICAgIHJlc3VsdFdpZHRoID0gd2luZG93V2lkdGggLSBpdGVtV2lkdGggKiBpdGVtcy5sZW5ndGg7XHJcbi8vICAgfVxyXG5cclxuLy8gICBpZiAoaXNNb2JpbGUpIHtcclxuLy8gICAgIHJlc3VsdFdpZHRoID0gd2luZG93V2lkdGggLSBpdGVtV2lkdGg7XHJcbi8vICAgfVxyXG5cclxuLy8gICByZXR1cm4gcmVzdWx0V2lkdGg7XHJcbi8vIH07XHJcblxyXG4vLyBjb25zdCBzZXRJdGVtV2lkdGggPSAoaXRlbSwgd2lkdGgpID0+IHtcclxuLy8gICBjb25zdCBpdGVtQ29udGVudCA9IGl0ZW0ubmV4dEVsZW1lbnRTaWJsaW5nO1xyXG4vLyAgIGNvbnN0IGl0ZW1UZXh0ID0gaXRlbUNvbnRlbnQuZmlyc3RFbGVtZW50Q2hpbGQ7XHJcbi8vICAgaXRlbUNvbnRlbnQuc3R5bGUud2lkdGggPSBgJHt3aWR0aH1weGA7XHJcbi8vICAgaXRlbVRleHQuc3R5bGUud2lkdGggPSBgJHt3aWR0aH1weGA7XHJcbi8vIH07XHJcblxyXG4vLyBjb25zdCBjbG9zZUl0ZW0gPSAoaXRlbSkgPT4ge1xyXG4vLyAgIGNvbnN0IGl0ZW1QYXJlbnQgPSBpdGVtLnBhcmVudEVsZW1lbnQ7XHJcbi8vICAgaXRlbVBhcmVudC5jbGFzc0xpc3QucmVtb3ZlKFwibWVudS1hY2NvX19pdGVtLS1hY3RpdmVcIik7XHJcbi8vICAgaXRlbS5jbGFzc0xpc3QucmVtb3ZlKFwibWVudS1hY2NvX19idXR0b24tLWFjdGl2ZVwiKTtcclxuLy8gICBzZXRJdGVtV2lkdGgoaXRlbSwgMCk7XHJcbi8vIH07XHJcblxyXG4vLyBjb25zdCBvcGVuSXRlbSA9IChpdGVtKSA9PiB7XHJcbi8vICAgY29uc3QgaXRlbVBhcmVudCA9IGl0ZW0ucGFyZW50RWxlbWVudDtcclxuLy8gICBpdGVtUGFyZW50LmNsYXNzTGlzdC5hZGQoXCJtZW51LWFjY29fX2l0ZW0tLWFjdGl2ZVwiKTtcclxuLy8gICBpdGVtLmNsYXNzTGlzdC5hZGQoXCJtZW51LWFjY29fX2J1dHRvbi0tYWN0aXZlXCIpO1xyXG4vLyAgIGNvbnN0IHdpZHRoID0gZ2V0SXRlbVdpZHRoKGl0ZW0pO1xyXG4vLyAgIHNldEl0ZW1XaWR0aChpdGVtLCB3aWR0aCk7XHJcbi8vIH07XHJcblxyXG4vLyBtZW51LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xyXG4vLyAgIGUucHJldmVudERlZmF1bHQoKTtcclxuLy8gICBjb25zdCB0YXJnZXQgPSBlLnRhcmdldDtcclxuLy8gICBjb25zdCBpc0FjdGl2ZSA9IHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtZW51LWFjY29fX2J1dHRvbi0tYWN0aXZlXCIpO1xyXG4vLyAgIGNvbnN0IGFjdGl2ZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1lbnUtYWNjb19fYnV0dG9uLS1hY3RpdmVcIik7XHJcblxyXG4vLyAgIGlmICh0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibWVudS1hY2NvX19idXR0b25cIikgJiYgaXNBY3RpdmUpIHtcclxuLy8gICAgIGlmIChhY3RpdmVFbGVtZW50KSB7XHJcbi8vICAgICAgIGNsb3NlSXRlbShhY3RpdmVFbGVtZW50KTtcclxuLy8gICAgIH1cclxuLy8gICB9XHJcbi8vICAgaWYgKHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtZW51LWFjY29fX2J1dHRvblwiKSAmJiAhaXNBY3RpdmUpIHtcclxuLy8gICAgIGlmIChhY3RpdmVFbGVtZW50KSB7XHJcbi8vICAgICAgIGNsb3NlSXRlbShhY3RpdmVFbGVtZW50KTtcclxuLy8gICAgIH1cclxuLy8gICAgIG9wZW5JdGVtKHRhcmdldCk7XHJcbi8vICAgfVxyXG4vLyB9KTtcclxuXHJcbi8vIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwicmVzaXplXCIsICgpID0+IHtcclxuLy8gICBjb25zdCBhY3RpdmVCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1lbnUtYWNjb19fYnV0dG9uLS1hY3RpdmVcIik7XHJcbi8vICAgaWYgKGFjdGl2ZUJ1dHRvbikge1xyXG4vLyAgICAgY2xvc2VJdGVtKGFjdGl2ZUJ1dHRvbik7XHJcbi8vICAgfVxyXG4vLyB9KTtcclxuXHJcbn0pKCk7IiwiY29uc3Qgc2VjdGlvbnMgPSAkKFwic2VjdGlvblwiKTtcclxuY29uc3QgZGlzcGxheSA9ICQoXCIubWFpbi1jb250ZW50XCIpO1xyXG5jb25zdCBzaWRlTWVudSA9ICQoXCIuZml4ZWQtbWVudVwiKTtcclxuY29uc3QgbWVudUl0ZW1zID0gc2lkZU1lbnUuZmluZChcIi5maXhlZC1tZW51X19pdGVtXCIpO1xyXG5cclxuY29uc3QgbW9iaWxlRGV0ZWN0ID0gbmV3IE1vYmlsZURldGVjdCh3aW5kb3cubmF2aWdhdG9yLnVzZXJBZ2VudCk7XHJcbmNvbnN0IGlzTW9iaWxlID0gbW9iaWxlRGV0ZWN0Lm1vYmlsZSgpO1xyXG5cclxuXHJcbmxldCBpblNjcm9sbCA9IGZhbHNlO1xyXG5cclxuc2VjdGlvbnMuZmlyc3QoKS5hZGRDbGFzcyhcImFjdGl2ZVwiKTtcclxuXHJcbmNvbnN0IGNvdW50U2VjdGlvblBvc2l0aW9uID0gc2VjdGlvbkVxID0+IHtcclxuICBjb25zdCBwb3NpdGlvbiA9IHNlY3Rpb25FcSAqIC0xMDA7XHJcblxyXG4gIGlmIChpc05hTihwb3NpdGlvbikpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoXCLQv9C10YDQtdC00LDQvdC+INC90LXQstC10YDQvdC+0LUg0LfQvdCw0YfQtdC90LjQtSDQsiBjb3VudFNlY3Rpb25Qb3NpdGlvblwiKTtcclxuICAgIHJldHVybiAwO1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIHBvc2l0aW9uO1xyXG59XHJcblxyXG5jb25zdCBjaGFuZ2VNZW51VGhlbWVGb3JTZWN0aW9uID0gc2VjdGlvbkVxID0+IHtcclxuICBjb25zdCBjdXJyZW50U2VjdGlvbiA9IHNlY3Rpb25zLmVxKHNlY3Rpb25FcSk7XHJcbiAgY29uc3QgbWVudVRoZW1lID0gY3VycmVudFNlY3Rpb24uYXR0cihcImRhdGEtc2lkZW1lbnUtdGhlbWVcIik7XHJcbiAgY29uc3Qgc2lkZU1lbnVMaW5rID0gJChcIi5maXhlZC1tZW51X19saW5rXCIpO1xyXG4gIGNvbnN0IGFjdGl2ZUNsYXNzID0gKFwiZml4ZWQtbWVudS0tbGlnaHRcIik7XHJcblxyXG5cclxuICBpZiAobWVudVRoZW1lID09PSBcIndoaXRlXCIpIHtcclxuICAgIHNpZGVNZW51LmFkZENsYXNzKGFjdGl2ZUNsYXNzKSxcclxuICAgICAgc2lkZU1lbnVMaW5rLmFkZENsYXNzKFwiZml4ZWQtbWVudV9fbGluay0tbGlnaHRcIik7XHJcbiAgfSBlbHNlIHtcclxuICAgIHNpZGVNZW51LnJlbW92ZUNsYXNzKFwiZml4ZWQtbWVudS0tc2hhZG93ZWRcIiksXHJcbiAgICAgIHNpZGVNZW51TGluay5yZW1vdmVDbGFzcyhcImZpeGVkLW1lbnVfX2xpbmstLWxpZ2h0XCIpO1xyXG4gIH1cclxufVxyXG5cclxuY29uc3QgcmVzZXRBY3RpdmVDbGFzc0Zvckl0ZW0gPSAoaXRlbXMsIGl0ZW1FcSwgYWN0aXZlQ2xhc3MpID0+IHtcclxuICBpdGVtcy5lcShpdGVtRXEpLmFkZENsYXNzKGFjdGl2ZUNsYXNzKS5zaWJsaW5ncygpLnJlbW92ZUNsYXNzKGFjdGl2ZUNsYXNzKTtcclxufVxyXG5cclxuY29uc3QgcGVyZm9ybVRyYW5zaXRpb24gPSAoc2VjdGlvbkVxKSA9PiB7XHJcbiAgaWYgKGluU2Nyb2xsKSByZXR1cm47XHJcblxyXG4gIGNvbnN0IHRyYW5zaXRpb25PdmVyID0gMTAwMDtcclxuICBjb25zdCBtb3VzZUluZXJ0aWFPdmVyID0gMDtcclxuXHJcbiAgaW5TY3JvbGwgPSB0cnVlO1xyXG5cclxuICBjb25zdCBwb3NpdGlvbiA9IGNvdW50U2VjdGlvblBvc2l0aW9uKHNlY3Rpb25FcSk7XHJcblxyXG4gIGNoYW5nZU1lbnVUaGVtZUZvclNlY3Rpb24oc2VjdGlvbkVxKTtcclxuXHJcbiAgZGlzcGxheS5jc3Moe1xyXG4gICAgdHJhbnNmb3JtOiBgdHJhbnNsYXRlWSgke3Bvc2l0aW9ufSUpYCxcclxuICB9KTtcclxuXHJcbiAgcmVzZXRBY3RpdmVDbGFzc0Zvckl0ZW0oc2VjdGlvbnMsIHNlY3Rpb25FcSwgXCJhY3RpdmVcIik7XHJcblxyXG4gIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgaW5TY3JvbGwgPSBmYWxzZTtcclxuXHJcbiAgICByZXNldEFjdGl2ZUNsYXNzRm9ySXRlbShtZW51SXRlbXMsIHNlY3Rpb25FcSwgXCJmaXhlZC1tZW51X19pdGVtLS1hY3RpdmVcIik7XHJcbiAgfSwgdHJhbnNpdGlvbk92ZXIgKyBtb3VzZUluZXJ0aWFPdmVyKTtcclxuXHJcbn07XHJcblxyXG5jb25zdCB2aWV3cG9ydFNjcm9sbGVyID0gKCkgPT4ge1xyXG4gIGNvbnN0IGFjdGl2ZVNlY3Rpb24gPSBzZWN0aW9ucy5maWx0ZXIoXCIuYWN0aXZlXCIpO1xyXG4gIGNvbnN0IG5leHRTZWN0aW9uID0gYWN0aXZlU2VjdGlvbi5uZXh0KCk7XHJcbiAgY29uc3QgcHJldlNlY3Rpb24gPSBhY3RpdmVTZWN0aW9uLnByZXYoKTtcclxuXHJcbiAgcmV0dXJuIHtcclxuICAgIG5leHQoKSB7XHJcbiAgICAgIGlmIChuZXh0U2VjdGlvbi5sZW5ndGgpIHtcclxuICAgICAgICBwZXJmb3JtVHJhbnNpdGlvbihuZXh0U2VjdGlvbi5pbmRleCgpKTtcclxuICAgICAgfVxyXG4gICAgfSxcclxuICAgIHByZXYoKSB7XHJcbiAgICAgIGlmIChwcmV2U2VjdGlvbi5sZW5ndGgpIHtcclxuICAgICAgICBwZXJmb3JtVHJhbnNpdGlvbihwcmV2U2VjdGlvbi5pbmRleCgpKTtcclxuICAgICAgfVxyXG4gICAgfSxcclxuICB9O1xyXG59O1xyXG5cclxuJCh3aW5kb3cpLm9uKFwid2hlZWxcIiwgKGUpID0+IHtcclxuICBjb25zdCBkZWx0YVkgPSBlLm9yaWdpbmFsRXZlbnQuZGVsdGFZO1xyXG4gIGNvbnN0IHNjcm9sbGVyID0gdmlld3BvcnRTY3JvbGxlcigpO1xyXG5cclxuICBpZiAoZGVsdGFZID4gMCkge1xyXG4gICAgc2Nyb2xsZXIubmV4dCgpO1xyXG4gIH1cclxuXHJcbiAgaWYgKGRlbHRhWSA8IDApIHtcclxuICAgIHNjcm9sbGVyLnByZXYoKTtcclxuICB9XHJcbn0pO1xyXG5cclxuJCh3aW5kb3cpLm9uKFwia2V5ZG93blwiLCAoZSkgPT4ge1xyXG4gIGNvbnN0IHRhZ05hbWUgPSBlLnRhcmdldC50YWdOYW1lLnRvTG93ZXJDYXNlKCk7XHJcbiAgY29uc3QgdXNlclR5cGluZ0luSW5wdXRzID0gdGFnTmFtZSA9PT0gXCJpbnB1dFwiIHx8IHRhZ05hbWUgPT09IFwidGV4dGFyZWFcIjtcclxuICBjb25zdCBzY3JvbGxlciA9IHZpZXdwb3J0U2Nyb2xsZXIoKTtcclxuXHJcbiAgaWYgKHVzZXJUeXBpbmdJbklucHV0cykgcmV0dXJuO1xyXG5cclxuICBzd2l0Y2ggKGUua2V5Q29kZSkge1xyXG4gICAgY2FzZSAzODpcclxuICAgICAgc2Nyb2xsZXIucHJldigpO1xyXG4gICAgICBicmVhaztcclxuXHJcbiAgICBjYXNlIDQwOlxyXG4gICAgICBzY3JvbGxlci5uZXh0KCk7XHJcbiAgICAgIGJyZWFrO1xyXG4gIH1cclxufSk7XHJcblxyXG4kKFwiLndyYXBwZXJcIikub24oXCJ0b3VjaG1vdmVcIiwgZSA9PiBlLnByZXZlbnREZWZhdWx0KCkpO1xyXG5cclxuJChcIltkYXRhLXNjcm9sbC10b11cIikuY2xpY2soKGUpID0+IHtcclxuICBlLnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gIGNvbnN0ICR0aGlzID0gJChlLmN1cnJlbnRUYXJnZXQpO1xyXG4gIGNvbnN0IHRhcmdldCA9ICR0aGlzLmF0dHIoXCJkYXRhLXNjcm9sbC10b1wiKTtcclxuICBjb25zdCByZXFTZWN0aW9uID0gJChgW2RhdGEtc2VjdGlvbi1pZD0ke3RhcmdldH1dYCk7XHJcblxyXG4gIHBlcmZvcm1UcmFuc2l0aW9uKHJlcVNlY3Rpb24uaW5kZXgoKSk7XHJcbn0pO1xyXG5cclxuaWYgKGlzTW9iaWxlKSB7XHJcblxyXG4kKFwiYm9keVwiKS5zd2lwZSh7XHJcbiAgc3dpcGU6IGZ1bmN0aW9uIChldmVudCwgZGlyZWN0aW9uKSB7XHJcbiAgICBjb25zdCBzY3JvbGxlciA9IHZpZXdwb3J0U2Nyb2xsZXIoKTtcclxuICAgIGxldCBzY3JvbGxEaXJlY3Rpb24gPSBcIlwiO1xyXG4gICAgXHJcbiAgICBpZiAoZGlyZWN0aW9uID09PSBcInVwXCIpIHNjcm9sbERpcmVjdGlvbiA9IFwibmV4dFwiO1xyXG4gICAgaWYgKGRpcmVjdGlvbiA9PT0gXCJkb3duXCIpIHNjcm9sbERpcmVjdGlvbiA9IFwicHJldlwiO1xyXG5cclxuICAgIGlmIChzY3JvbGxEaXJlY3Rpb24pIHtcclxuICAgICAgc2Nyb2xsZXJbc2Nyb2xsRGlyZWN0aW9uXSgpO1xyXG4gICAgfVxyXG4gIH0sXHJcbn0pO1xyXG59XHJcblxyXG5cclxuLy8gY29uc3Qgc2VjdGlvbnMgPSAkKFwic2VjdGlvblwiKTtcclxuLy8gY29uc3QgZGlzcGxheSA9ICQoXCIubWFpbi1jb250ZW50XCIpXHJcbi8vIGNvbnN0IG1vYmlsZURldGVjdCA9IG5ldyBNb2JpbGVEZXRlY3Qod2luZG93Lm5hdmlnYXRvci51c2VyQWdlbnQpO1xyXG4vLyBjb25zdCBpc01vYmlsZSA9IG1vYmlsZURldGVjdC5tb2JpbGUoKTtcclxuXHJcbi8vIGxldCBpblNjcm9sbCA9IGZhbHNlO1xyXG5cclxuLy8gc2VjdGlvbnMuZmlyc3QoKS5hZGRDbGFzcyhcInNlY3Rpb24tLWFjdGl2ZVwiKTtcclxuXHJcbi8vIGNvbnN0IHBlcmZvcm1UcmFuc2l0aW9uID0gc2VjdGlvbkVxID0+IHtcclxuXHJcbi8vICAgICBpZiAoaW5TY3JvbGwgPT09IGZhbHNlKSB7XHJcbi8vICAgICAgICAgaW5TY3JvbGwgPSB0cnVlO1xyXG4vLyAgICAgICAgIGNvbnN0IHBvc2l0aW9uID0gc2VjdGlvbkVxICogLTEwMDtcclxuXHJcbi8vICAgICAgICAgY29uc3QgY3VycmVudFNlY3Rpb24gPSBzZWN0aW9ucy5lcShzZWN0aW9uRXEpO1xyXG4vLyAgICAgICAgIGNvbnN0IG1lbnVUaGVtZSA9IGN1cnJlbnRTZWN0aW9uLmF0dHIoXCJkYXRhLXNpZGVtZW51LXRoZW1lXCIpO1xyXG4vLyAgICAgICAgIGNvbnN0IHNpZGVNZW51ID0gJChcIi5maXhlZC1tZW51XCIpO1xyXG5cclxuXHJcbi8vICAgICAgICAgaWYgKG1lbnVUaGVtZSA9PT0gXCJ3aGl0ZVwiKSB7XHJcbi8vICAgICAgICAgICAgIHNpZGVNZW51LmFkZENsYXNzKFwiZml4ZWQtbWVudV9fbGluay0tdGhlbWUtLWxpZ2h0XCIpO1xyXG4vLyAgICAgICAgIH0gZWxzZSB7XHJcbi8vICAgICAgICAgICAgIHNpZGVNZW51LnJlbW92ZUNsYXNzKFwiZml4ZWQtbWVudV9fbGluay0tdGhlbWUtLWxpZ2h0XCIpO1xyXG4vLyAgICAgICAgIH1cclxuXHJcbi8vICAgICAgICAgZGlzcGxheS5jc3Moe1xyXG4vLyAgICAgICAgICAgICB0cmFuc2Zvcm06IGB0cmFuc2xhdGVZKCR7cG9zaXRpb259JSlgXHJcbi8vICAgICAgICAgfSlcclxuICAgIFxyXG4vLyAgICAgICAgIHNlY3Rpb25zLmVxKHNlY3Rpb25FcSkuYWRkQ2xhc3MoXCJzZWN0aW9uLS1hY3RpdmVcIikuc2libGluZ3MoKS5yZW1vdmVDbGFzcyhcInNlY3Rpb24tLWFjdGl2ZVwiKTtcclxuICAgICAgICBcclxuICAgICAgICBcclxuXHJcbi8vICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbi8vICAgICAgICAgICAgIGluU2Nyb2xsID0gZmFsc2U7XHJcblxyXG4vLyAgICAgICAgICAgICBzaWRlTWVudS5maW5kKFwiLmZpeGVkLW1lbnVfX2l0ZW1cIikuZXEoc2VjdGlvbkVxKS5hZGRDbGFzcyhcImZpeGVkLW1lbnVfX2l0ZW0tLWFjdGl2ZVwiKS5zaWJsaW5ncygpLnJlbW92ZUNsYXNzKFwiZml4ZWQtbWVudV9faXRlbS0tYWN0aXZlXCIpO1xyXG5cclxuLy8gICAgICAgICB9LCAxMzAwKTtcclxuLy8gICAgIH1cclxuXHJcbiAgIFxyXG4vLyB9O1xyXG5cclxuLy8gY29uc3Qgc2Nyb2xsVmlld3BvcnQgPSBkaXJlY3Rpb24gPT4ge1xyXG5cclxuLy8gICAgIGNvbnN0IGFjdGl2ZVNlY3Rpb24gPSBzZWN0aW9ucy5maWx0ZXIoXCIuc2VjdGlvbi0tYWN0aXZlXCIpO1xyXG4vLyAgICAgY29uc3QgbmV4dFNlY3Rpb24gPSBhY3RpdmVTZWN0aW9uLm5leHQoKTtcclxuLy8gICAgIGNvbnN0IHByZXZTZWN0aW9uID0gYWN0aXZlU2VjdGlvbi5wcmV2KCk7XHJcblxyXG4vLyAgICAgaWYgKGRpcmVjdGlvbiA9PT0gXCJuZXh0XCIgJiYgbmV4dFNlY3Rpb24ubGVuZ3RoKSB7XHJcbi8vICAgICAgICAgcGVyZm9ybVRyYW5zaXRpb24obmV4dFNlY3Rpb24uaW5kZXgoKSk7XHJcbi8vICAgICB9XHJcblxyXG4vLyAgICAgaWYgKGRpcmVjdGlvbiA9PT0gXCJwcmV2XCIgJiYgcHJldlNlY3Rpb24ubGVuZ3RoKSB7XHJcbi8vICAgICAgICAgcGVyZm9ybVRyYW5zaXRpb24ocHJldlNlY3Rpb24uaW5kZXgoKSk7XHJcbi8vICAgICB9XHJcbi8vIH07XHJcblxyXG5cclxuLy8gJCh3aW5kb3cpLm9uKFwid2hlZWxcIiwgZSA9PiB7XHJcbi8vICAgICBjb25zdCBkZWx0YVkgPSBlLm9yaWdpbmFsRXZlbnQuZGVsdGFZO1xyXG5cclxuLy8gICAgIGlmIChkZWx0YVkgPiAwKSB7XHJcbi8vICAgICAgICAgc2Nyb2xsVmlld3BvcnQoXCJuZXh0XCIpO1xyXG5cclxuLy8gICAgIH1cclxuXHJcbi8vICAgICBpZiAoZGVsdGFZIDwgMCkge1xyXG4vLyAgICAgICAgIHNjcm9sbFZpZXdwb3J0KFwicHJldlwiKTtcclxuXHJcbi8vICAgICB9XHJcblxyXG4vLyB9KTtcclxuXHJcbi8vICAkKHdpbmRvdykub24oXCJrZXlkb3duXCIsIChlKSA9PiB7XHJcbi8vICAgICBjb25zdCB0YWdOYW1lID0gZS50YXJnZXQudGFnTmFtZS50b0xvd2VyQ2FzZSgpO1xyXG5cclxuLy8gICAgIGlmICh0YWdOYW1lICE9IFwiaW5wdXRcIiAmJiB0YWdOYW1lICE9IFwidGV4dGFyZWFcIikge1xyXG4vLyAgICAgICAgIHN3aXRjaCAoZS5rZXlDb2RlKXtcclxuLy8gICAgICAgICAgICAgY2FzZSAzODpcclxuLy8gICAgICAgICAgICAgICAgIHNjcm9sbFZpZXdwb3J0KFwicHJldlwiKTtcclxuLy8gICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgXHJcbi8vICAgICAgICAgICAgIGNhc2UgNDA6XHJcbi8vICAgICAgICAgICAgICAgICBzY3JvbGxWaWV3cG9ydChcIm5leHRcIik7XHJcbi8vICAgICAgICAgICAgICAgICBicmVhaztcclxuLy8gICAgICAgICB9XHJcbi8vICAgICB9XHJcblxyXG5cclxuLy8gfSk7XHJcblxyXG4vLyAkKFwiLndyYXBwZXJcIikub24oXCJ0b3VjaG1vdmVcIiwgZSA9PiBlLnByZXZlbnREZWZhdWx0KCkpO1xyXG5cclxuLy8gJChcIltkYXRhLXNjcm9sbC10b11cIikuY2xpY2soZSA9PiB7XHJcbi8vICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4vLyAgICAgY29uc3QgJHRoaXMgPSAkKGUuY3VycmVudFRhcmdldCk7XHJcbi8vICAgICBjb25zdCB0YXJnZXQgPSAkdGhpcy5hdHRyKFwiZGF0YS1zY3JvbGwtdG9cIik7XHJcbi8vICAgICBjb25zdCByZXFTZWN0aW9uID0gJChgW2RhdGEtc2VjdGlvbi1pZD0ke3RhcmdldH1dYCk7XHJcblxyXG4vLyAgICAgcGVyZm9ybVRyYW5zaXRpb24ocmVxU2VjdGlvbi5pbmRleCgpKTtcclxuXHJcbi8vIH0pO1xyXG5cclxuLy8gaWYgKGlzTW9iaWxlKSB7XHJcbi8vICAgICAkKFwiYm9keVwiKS5zd2lwZSh7XHJcbi8vICAgICAgICAgcHJldmVudERlZmF1bHRFdmVudHM6IGZhbHNlLCBcclxuLy8gICAgICAgICBzd2lwZTogZnVuY3Rpb24gKGV2ZW50LCBkaXJlY3Rpb24pIHtcclxuICAgICAgICAgICAgXHJcbi8vICAgICAgICAgICAgIGlmIChkaXJlY3Rpb24gPT09IFwidXBcIikge1xyXG4vLyAgICAgICAgICAgICAgICAgc2Nyb2xsVmlld3BvcnQoXCJuZXh0XCIpO1xyXG4vLyAgICAgICAgIH1cclxuLy8gICAgICAgICAgICAgaWYgKGRpcmVjdGlvbiA9PT0gXCJkb3duXCIpIHtcclxuLy8gICAgICAgICAgICAgICAgIHNjcm9sbFZpZXdwb3J0KFwicHJldlwiKTtcclxuLy8gICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4vLyAgICAgICAgIH0sXHJcbi8vICAgICB9KTtcclxuLy8gfVxyXG5cclxuLy8gLy8gLy8gaHR0cHM6Ly9naXRodWIuY29tL21hdHRicnlzb24vVG91Y2hTd2lwZS1KcXVlcnktUGx1Z2luXHJcblxyXG5cclxuXHJcblxyXG5cclxuIiwiY29uc3QgcGFnZVNjcm9sbCA9IHtcclxuICBibG9jazogKCkgPT4ge1xyXG4gICAgY29uc29sZS5sb2coXCJibG9jayFcIik7XHJcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcImlzU2Nyb2xsTG9ja2VkXCIsIHRydWUpO1xyXG4gIH0sXHJcbiAgdW5ibG9jazogKCkgPT4ge1xyXG4gICAgY29uc29sZS5sb2coXCJ1bmJsb2NrIVwiKTtcclxuICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFwiaXNTY3JvbGxMb2NrZWRcIiwgZmFsc2UpO1xyXG4gIH0sXHJcbiAgdG9nZ2xlQmxvY2s6IGZ1bmN0aW9uICgpIHtcclxuICAgIGlmICh0aGlzLmlzQmxvY2tlZCgpKSB7XHJcbiAgICAgIHRoaXMudW5ibG9jaygpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5ibG9jaygpO1xyXG4gICAgfVxyXG4gIH0sXHJcblxyXG4gIGlzQmxvY2tlZDogKCkgPT4ge1xyXG4gICAgY29uc29sZS5sb2coXCJibG9ja2VkP1wiLCBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcImlzU2Nyb2xsTG9ja2VkXCIpKTtcclxuICAgIHJldHVybiBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiaXNTY3JvbGxMb2NrZWRcIikpO1xyXG4gIH0sXHJcbn1cclxuXHJcbnBhZ2VTY3JvbGwudW5ibG9jaygpOyIsImNvbnN0IHNsaWRlciA9ICQoJy5zaG9wX19saXN0JykuYnhTbGlkZXIoe1xyXG4gICAgcGFnZXI6IGZhbHNlLFxyXG4gICAgY29udHJvbHM6ZmFsc2VcclxufSk7XHJcblxyXG4kKCcuc2hvcF9fYnRuX2xlZnQnKS5jbGljayhldmVudCA9PiB7XHJcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgc2xpZGVyLmdvVG9QcmV2U2xpZGUoKTtcclxufSk7XHJcblxyXG4kKCcuc2hvcF9fYnRuX3JpZ2h0JykuY2xpY2soZXZlbnQgPT4ge1xyXG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIHNsaWRlci5nb1RvTmV4dFNsaWRlKCk7XHJcbn0pOyIsIi8vIGxldCBsaXN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0ZWFtTGlzdFwiKTtcclxuXHJcbi8vIGNvbnN0IGJ1dHRvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcudGVhbV9fbmFtZScpO1xyXG5cclxuLy8gZnVuY3Rpb24gY2xvc2VFdmVyeUl0ZW0oKSB7XHJcbi8vICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGJ1dHRvbnMubGVuZ3RoOyBpKyspIHtcclxuLy8gICAgICAgICBjb25zdCBidXR0b24gPSBidXR0b25zW2ldO1xyXG4vLyAgICAgICAgIGNvbnN0IGRlc2NyaXB0aW9uID0gYnV0dG9uLm5leHRFbGVtZW50U2libGluZztcclxuLy8gICAgICAgICBkZXNjcmlwdGlvbi5jbGFzc0xpc3QucmVtb3ZlKCd0ZWFtX19kZXNjLS1hY3RpdmUnKTtcclxuLy8gICAgICAgICBidXR0b24uY2xhc3NMaXN0LnJlbW92ZSgndGVhbV9fbmFtZS0tYWN0aXZlJyk7XHJcblxyXG4vLyAgICAgfVxyXG4vLyB9XHJcblxyXG4vLyBsaXN0LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoZXZlbnQpIHtcclxuLy8gICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4vLyAgICAgY29uc3QgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0O1xyXG4vLyAgICAgaWYgKHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJ0ZWFtX19uYW1lXCIpKSB7XHJcbi8vICAgICAgICAgY29uc3QgZGVzY3JpcHRpb24gPSB0YXJnZXQubmV4dEVsZW1lbnRTaWJsaW5nO1xyXG5cclxuLy8gICAgICAgICBpZiAoZGVzY3JpcHRpb24uY2xhc3NMaXN0LmNvbnRhaW5zKCd0ZWFtX19kZXNjLS1hY3RpdmUnKSkge1xyXG4vLyAgICAgICAgICAgICBjbG9zZUV2ZXJ5SXRlbSgpO1xyXG4vLyAgICAgICAgIH0gZWxzZSB7XHJcbi8vICAgICAgICAgICAgIGNsb3NlRXZlcnlJdGVtKCk7XHJcbi8vICAgICAgICAgICAgIGRlc2NyaXB0aW9uLmNsYXNzTGlzdC5hZGQoJ3RlYW1fX2Rlc2MtLWFjdGl2ZScpO1xyXG4vLyAgICAgICAgICAgICB0YXJnZXQuY2xhc3NMaXN0LmFkZCgndGVhbV9fbmFtZS0tYWN0aXZlJyk7XHJcbi8vICAgICAgICAgfVxyXG4vLyAgICAgfVxyXG4vLyB9KSBcclxuXHJcbi8vIGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCBidXR0b25zLmxlbmd0aDsgaW5kZXgrKykge1xyXG4vLyAgICAgY29uc3QgYnV0dG9uID0gYnV0dG9uc1tpbmRleF07XHJcblxyXG4vLyAgICAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGV2ZW50KSB7XHJcbi8vICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuLy8gICAgICAgICBjb25zdCB0YXJnZXQgPSBldmVudC50YXJnZXQ7XHJcbi8vICAgICAgICAgY29uc3QgZGVzY3JpcHRpb24gPSB0YXJnZXQubmV4dEVsZW1lbnRTaWJsaW5nO1xyXG5cclxuLy8gICAgICAgICBpZiAoZGVzY3JpcHRpb24uY2xhc3NMaXN0LmNvbnRhaW5zKCd0ZWFtX19kZXNjLS1hY3RpdmUnKSkge1xyXG4vLyAgICAgICAgICAgICBkZXNjcmlwdGlvbi5jbGFzc0xpc3QucmVtb3ZlKCd0ZWFtX19kZXNjLS1hY3RpdmUnKTtcclxuLy8gICAgICAgICB9IGVsc2Uge1xyXG4vLyAgICAgICAgICAgICBjbG9zZUV2ZXJ5SXRlbSgpO1xyXG4vLyAgICAgICAgICAgICBkZXNjcmlwdGlvbi5jbGFzc0xpc3QuYWRkKCd0ZWFtX19kZXNjLS1hY3RpdmUnKTtcclxuLy8gICAgICAgICB9XHJcblxyXG4vLyAgICAgfSlcclxuLy8gfVxyXG5cclxuY29uc3Qgb3Blbkl0ZW0gPSBpdGVtID0+IHtcclxuICAgIGNvbnN0IGNvbnRhaW5lciA9IGl0ZW0uY2xvc2VzdChcIi50ZWFtX19pdGVtXCIpO1xyXG4gICAgY29uc3QgY29udGVudEJsb2NrID0gY29udGFpbmVyLmZpbmQoXCIudGVhbV9fY29udGVudFwiKTtcclxuICAgIGNvbnN0IHRleHRCbG9jayA9IGNvbnRlbnRCbG9jay5maW5kKFwiLnRlYW1fX2NvbnRlbnQtYmxvY2tcIik7IFxyXG4gICAgY29uc3QgcmVxSGVpZ2h0ID0gdGV4dEJsb2NrLmhlaWdodCgpO1xyXG4gICAgY29uc3Qgc3ZnSWNvbiA9IGNvbnRhaW5lci5maW5kKFwiLnRlYW1fX2ljb24taW1nXCIpO1xyXG4gIFxyXG4gICAgY29udGFpbmVyLmFkZENsYXNzKFwiYWN0aXZlXCIpO1xyXG4gICAgc3ZnSWNvbi5hZGRDbGFzcyhcInRlYW1fX2ljb24taW1nLS1hY3RpdmVcIik7XHJcbiAgICBjb250ZW50QmxvY2suaGVpZ2h0KHJlcUhlaWdodCk7XHJcbiAgfVxyXG4gIFxyXG4gIGNvbnN0IGNsb3NlRXZlcnlJdGVtID0gY29udGFpbmVyID0+IHtcclxuICAgIGNvbnN0IGl0ZW1zID0gY29udGFpbmVyLmZpbmQoXCIudGVhbV9fY29udGVudFwiKTtcclxuICAgIGNvbnN0IGl0ZW1Db250YWluZXIgPSBjb250YWluZXIuZmluZChcIi50ZWFtX19pdGVtXCIpO1xyXG4gICAgY29uc3QgaXRlbVN2Z0ljb24gPSBjb250YWluZXIuZmluZChcIi50ZWFtX19pY29uLWltZ1wiKTtcclxuICBcclxuICAgIGl0ZW1Db250YWluZXIucmVtb3ZlQ2xhc3MoXCJhY3RpdmVcIik7XHJcbiAgICBpdGVtU3ZnSWNvbi5yZW1vdmVDbGFzcyhcInRlYW1fX2ljb24taW1nLS1hY3RpdmVcIik7XHJcbiAgICBpdGVtcy5oZWlnaHQoMCk7XHJcbiAgfVxyXG4gIFxyXG4gICQoXCIudGVhbV9fYnV0dG9uXCIpLmNsaWNrKGUgPT4ge1xyXG4gICAgY29uc3QgJHRoaXMgPSAkKGUuY3VycmVudFRhcmdldCk7XHJcbiAgICBjb25zdCBjb250YWluZXIgPSAkdGhpcy5jbG9zZXN0KFwiLnRlYW1fX2xpc3RcIik7XHJcbiAgICBjb25zdCBlbGVtQ29udGFpbmVyID0gJHRoaXMuY2xvc2VzdChcIi50ZWFtX19pdGVtXCIpO1xyXG4gIFxyXG4gICAgaWYgKGVsZW1Db250YWluZXIuaGFzQ2xhc3MoXCJhY3RpdmVcIikpIHtcclxuICAgICAgY2xvc2VFdmVyeUl0ZW0oY29udGFpbmVyKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGNsb3NlRXZlcnlJdGVtKGNvbnRhaW5lcik7XHJcbiAgICAgIG9wZW5JdGVtKCR0aGlzKTtcclxuICAgIH1cclxuICB9KTtcclxuIl19
